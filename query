SELECT COUNT(*)
FROM public.meeting_records
WHERE environment = 'prod'
  AND region ILIKE '%au%'
  AND created_at >= CURRENT_DATE - INTERVAL '1 day'
  AND created_at < CURRENT_DATE;


SELECT mr.meeting_id
FROM public.meeting_records mr
LEFT JOIN public.transcripts t
  ON mr.meeting_id = t.meeting_id
WHERE mr.environment = 'prod'
  AND mr.region ILIKE '%au%'
  AND mr.created_at >= CURRENT_DATE - INTERVAL '1 day'
  AND mr.created_at < CURRENT_DATE
  AND t.meeting_id IS NULL;


SELECT meeting_id, retry_count, max_retries, processed
FROM public.transcripts
WHERE meeting_id IN (
  SELECT meeting_id
  FROM public.meeting_records
  WHERE environment = 'prod'
    AND region ILIKE '%au%'
    AND created_at >= CURRENT_DATE - INTERVAL '1 day'
    AND created_at < CURRENT_DATE
);



SELECT meeting_record_id, step_name, status
FROM public.pipeline_events
WHERE meeting_record_id IN (
  SELECT meeting_id
  FROM public.meeting_records
  WHERE environment = 'prod'
    AND region ILIKE '%au%'
    AND created_at >= CURRENT_DATE - INTERVAL '1 day'
    AND created_at < CURRENT_DATE
)
AND status <> 'SUCCESS';


SELECT meeting_id, processing_state
FROM public.meeting_records
WHERE environment = 'prod'
  AND region ILIKE '%au%'
  AND created_at >= CURRENT_DATE - INTERVAL '1 day'
  AND created_at < CURRENT_DATE
  AND processing_state <> 'COMPLETED';
