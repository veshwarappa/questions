SELECT
  mr.meeting_id,
  t.transcript_available_at,
  (mr.event_date::date + mr.end_time::time)                     AS scheduled_end_ts,
  (t.transcript_available_at - (mr.event_date::date + mr.end_time::time)) AS scheduled_delay,
  ROUND(EXTRACT(EPOCH FROM (t.transcript_available_at - (mr.event_date::date + mr.end_time::time))) / 60.0, 2)
                                                               AS scheduled_delay_minutes
FROM public.meeting_records mr
JOIN public.transcripts t
  ON t.meeting_id = mr.meeting_id
WHERE mr.meeting_id = 'AAMkADAy...';


SELECT
  mr.meeting_id,
  t.transcript_available_at,
  (NULLIF(mr.event_date,'')::date + NULLIF(mr.end_time,'')::time) AS scheduled_end_ts,
  (t.transcript_available_at - (NULLIF(mr.event_date,'')::date + NULLIF(mr.end_time,'')::time)) AS scheduled_delay,
  ROUND(EXTRACT(EPOCH FROM (t.transcript_available_at - (NULLIF(mr.event_date,'')::date + NULLIF(mr.end_time,'')::time))) / 60.0, 2)
    AS scheduled_delay_minutes
FROM public.meeting_records mr
JOIN public.transcripts t
  ON t.meeting_id = mr.meeting_id
WHERE mr.meeting_id = 'AAMkADAy...';


SELECT meeting_id, event_date, end_time
FROM public.meeting_records
WHERE meeting_id = 'AAMkADAy...';
