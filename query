SELECT
  mr.region,
  mr.environment,
  t.meeting_id,
  mr.event_date,
  mr.start_time,
  mr.end_time,
  mr.created_at            AS meeting_record_created_at,
  mr.payload_submitted_at,
  mr.completed_at          AS meeting_finished_at,
  t.created_at             AS transcript_row_created_at,
  t.transcript_available_at,
  t.last_checked_at,
  (t.transcript_available_at - mr.completed_at)
      AS delay_after_meeting_finished,

  (t.transcript_available_at - t.created_at)
      AS delay_after_transcript_row_created,
  t.processed,
  t.retry_count,
  t.max_retries

FROM public.transcripts t
JOIN public.meeting_records mr
  ON mr.meeting_id = t.meeting_id

WHERE t.transcript_available_at IS NOT NULL
  AND mr.completed_at IS NOT NULL

ORDER BY delay_after_meeting_finished DESC
LIMIT 20;
