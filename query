SELECT
  mr.meeting_id,
  (substring(t.meeting_date from 1 for 10) || ' ' ||
   substring(t.end_time from 1 for 8))::timestamp AS scheduled_end,
  t.transcript_available_at,
  ROUND(EXTRACT(EPOCH FROM (
    t.transcript_available_at -
    (substring(t.meeting_date from 1 for 10) || ' ' ||
     substring(t.end_time from 1 for 8))::timestamp
  ))/60.0,2) AS perceived_delay_min
FROM public.transcripts t
JOIN public.meeting_records mr ON mr.meeting_id = t.meeting_id
WHERE mr.environment='prod'
  AND mr.region='ANZ'
  AND t.meeting_date = '2026-02-17'
ORDER BY perceived_delay_min DESC;
