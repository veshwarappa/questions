SELECT
  mr.region,
  mr.meeting_id,
  mr.event_date,
  mr.start_time,
  mr.end_time,
  mr.created_at            AS meeting_created_at,
  mr.payload_submitted_at,
  mr.completed_at          AS meeting_finished_at,
  t.created_at             AS transcript_row_created_at,
  t.transcript_available_at,
  ROUND(
    EXTRACT(EPOCH FROM (t.transcript_available_at - mr.completed_at)) / 60.0,2) AS delay_after_finished_minutes,
  t.processed,
  t.retry_count,
  t.last_checked_at
FROM public.transcripts t
JOIN public.meeting_records mr
  ON mr.meeting_id = t.meeting_id
WHERE
  t.transcript_available_at IS NOT NULL
  AND mr.completed_at IS NOT NULL
  AND t.transcript_available_at >= NOW() - INTERVAL '7 days'
ORDER BY
  t.transcript_available_at DESC;
