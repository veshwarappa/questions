SELECT
  mr.region,
  ROUND(AVG(EXTRACT(EPOCH FROM (
    t.transcript_available_at - mr.completed_at
  ))/60.0),2) AS avg_delay_min,
  ROUND(MAX(EXTRACT(EPOCH FROM (
    t.transcript_available_at - mr.completed_at
  ))/60.0),2) AS max_delay_min
FROM public.meeting_records mr
JOIN public.transcripts t ON t.meeting_id = mr.meeting_id
WHERE mr.environment='prod'
  AND t.transcript_available_at >= '2026-02-01'::date
  AND t.transcript_available_at <  '2026-02-16'::date
  AND t.transcript_available_at IS NOT NULL
  AND mr.completed_at IS NOT NULL
GROUP BY mr.region
ORDER BY max_delay_min DESC;
